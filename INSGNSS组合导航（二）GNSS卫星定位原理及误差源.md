### INS/GNSS组合导航（二）GNSS卫星定位原理及误差源

##### GNSS的构成

主要分为三部分：空间段、控制段和用户段

- **空间段**众多的卫星称为**星座**，负责将信号广播给控制段和用户设备
  - 广播的信号包括测距码和导航电文
    - 通过测距码来确定接收信号的发射时刻
    - 导航电文包含时间信息和卫星轨道信息
  - 卫星的地面轨迹是星下点在地球表面的轨迹，重复周期是地球自转周期和卫星轨道周期的**最小公倍数**
- 控制段包括一个监测站网、一个或多个控制站和多个上行注入站
  - 监测站将**从卫星到监测站的测距信息**发送到控制站
  - 监测站位于**精确测定**的位置，有同步时钟，利用测距信息可以确定卫星轨道并矫正卫星时钟
  - 控制站计算导航电文信息，决定卫星是否需要变轨
- 用户段由接收机等构成
  - **天线**的功能是将输 入的GNSS无线电信号转化成**电信号**，然后送给接收机。
  - 接收机使用时钟**提供时间参考基准**，对天线提供的信号进行**解调**。
  - 测距处理器是对接收机**输出信号**进行处理，即采用**捕获和跟踪算法**确定天线至所收到的每一颗**卫星的距离**，同时也对接收机进行控制和对导航电文进行**解码**。
  - 导航处理器使用测距信息**确定位置、 速度和时间(Position,Velocity,and Time,PVT)解**。
- <img src="https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303142216964.png" alt="image-20230314221627445" style="zoom:80%;" />

#### 卫星定位原理

- 三维空间可以利用求解多元方程组得到GNSS导航定位解
  - 具体实现可以根据下面的图：<img src="https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303142223730.png" alt="image-20230314222331655" style="zoom:80%;" />
  - 单颗卫星时：一个圆，得到的解只有一个半径r的球面
  - 两个卫星：得到的是两个球中间的一个**位置面**(surface of position , SOP) 
  - 如果用第三个卫星，就限制在圆上的两个点
    - 对于大多数应用情况，实际上仅仅存在一个位置解，而另一个位置解可能在太空，也可能在地球内部或者是用户操作区域之外。如果两个解都可行的话，则可以使用第四个距离测量值来解决定位解的模糊性。
  - 根据接收机的**时钟**可以得到信号**到达的时间**$t_{sa}$，通过测距码和导航电文可以确定卫星信号的**发射时间**$t_{st}$，乘上光速c就可以得到距离卫星到用户的距离：$$\rho_{j}=\left(t_{s a, j}-t_{s t, j}\right) c$$
    - 但是在实际中，接收机和卫星的时钟不同步
      - 如果接收机时钟比系统的时钟快，测量的到达时间$\tilde{t}_{sa,j}$就会大于实际的到达时间，最终的距离测量值就会偏大
      - 如果卫星时钟比系统时钟快，那么实际的发送时间$t_{s t, j}$就会超前于预期的发送时间$\tilde t_{s t, j}$，最终的估计偏小
- 测量误差：![image-20230314231703723](https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303142317226.png)
  - 其中，$\delta t_{rc}$是接收机超前系统时间，$\delta t_{sj}$是第j颗卫星超前于系统时间
- 伪距：存在钟差且都没有修正的测量值
  - ![image-20230314232828294](https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303142328407.png)
  - 其中$r_{as}$是真实距离
  - <img src="https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303151006244.png" alt="image-20230315100657202" style="zoom:50%;" />
- 卫星的时钟差可以由控制段测量，因此导航处理器能够处理和**修正卫星钟差**
  - 但是接收机的钟差是未知的，但是所有同一时刻位居测量信息中的接收机钟差是相同的，可以当作**第四个未知量**来求解
  - 因此导航解是四维的，三个位置和一个钟差
- 四维导航的求解需要四个不同GNSS卫星（**四星定位**）
  - 四星定位的位置和中钟差是同时求解的
  - <img src="https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303151018742.png" alt="image-20230315101825660" style="zoom:50%;" />
  - 四颗卫星得到伪距（已经修正卫星钟差），并不是准确位置因此四个球不会相交于同一个点
  - 此时调整球的半径，可以让四个球交于一点，得到位置解
    - 此时球的半径就是**准确距离**，根据伪距和准确距离可以解出**由于接收机钟差导致的距离误差**，进一步可以解出接收机钟差
  - ![image-20230315102520586](https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303151025623.png)
    - $r^i_{isj}(t_{st,j})$的求解类似于前面提到的$$\rho_{j}=\left(t_{s a, j}-t_{s t, j}\right) c$$，但是实际不能简单认为是时间x光速，需要**导航电文**中广播的卫星轨道参数（**星历(ephemeris)**）
- 用同样的方法，采用一系列的伪距率测量值即伪距的变化率，可以求解用户天线的速度和接收机的钟差漂移
- 同时由于遮挡，同时接收到四颗卫星信号不是经常可行的，当卫星数小于4时，在一定时间内可以得到导航解

#### 误差源和性能限制

- GNSS**导航解计算的误差源**来自广播星历与真实星历间的误差和卫星钟差
  - 信号传播延迟误差来源于信号在电离层和对流层中的折射
    - 使用模型可以补偿电离层延迟
    - 如果使用多个频点的测距信息，就可以使用差分技术**确定**电离层延迟误差
- 接收机的测量误差来源于：接收机动态响应延迟、接收机噪声、射频干扰和信号的多路径干扰
  - GNSS信号被建筑物和地面反射，信号多于一路，产生多路经效应
- 接收机在定位过程中涉及的误差包括**卫星时钟钟差、接收机时钟钟差、电离层延时、对流层延时、多径误差、卫星轨道误差、接收机噪声、用户等距误差**

##### 环境影响

- 低仰角的卫星信号存在较大的电离层和对流层传播延迟
  - 也容易受到多路经干扰
  - 大多数GNSS 接收机摒弃低于某一仰角的卫星信号，该仰角称为屏蔽角。屏蔽角的值通常设为5°~15° 
- GNSS信号可能被建筑物、地形和用户设备的载体的一部分遮挡，接收机可能仅仅接受到**反射路径的信号**，称为**非视线（nonline - of - sight , NLOS)）**接收
  - 在城市峡谷中GNSS遮挡和多路经干扰较多
- <img src="https://raw.githubusercontent.com/zhaopy20/pictures/main/img/202303151156245.png" alt="image-20230315115610164" style="zoom:80%;" />

- 当信号衰减时，GNSS 性能也会下降，如在室内或者树下的环境。
  - 邻近频段的通信信号的RF 干扰、任意频段强信号的滤波留下的谐波和GNSS 信号本身的故意干扰都会造成GNSS 性能的下降
  - 与其他类型的无线电信号比较， GNSS 信号相当脆弱，因此它们很容易衰减和容易受到干扰

#### 高精度定位方法

##### 双频GNSS

- 利用不同频率的电磁波通过电离层时的不同延迟，可以利用两个或多个频率的观测值消除电离层误差

##### 地基/星基增强

- 星历误差、卫星时钟误差、甚至是电离层和对流层误差都是可以观测或建模，可以计算出实时的误差，并通过单独的通道播发，进行修正
  - 一种是直接卫星播发，称为SBAS(Satellite-Based Augmentation System)，好处是覆盖广，但设备需要增加额外的信号接收通道
  - 另一种是地基增强
  - 增强有限，电离层误差无法消除

##### 差分定位（RTK）